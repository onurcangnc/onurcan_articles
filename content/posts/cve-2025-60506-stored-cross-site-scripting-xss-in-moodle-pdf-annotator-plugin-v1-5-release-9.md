---
title: CVE-2025-60506 | Stored Cross-Site Scripting (XSS) in Moodle PDF
  Annotator plugin (v1.5 release 9)
date: 2025-10-17T20:11:00.000+03:00
description: The Public Comments feature & fileupload in the Moodle PDF
  Annotator plugin fails to sanitize user input before rendering it within the
  PDF viewer interface.
thumbnail: /uploads/74ec48d085c7cc2435043f0a069e759b916f0150.png
tags:
  - Cybersecurity
  - responsibledisclosure
  - Cybersecurity
  - Penetration Testing
---
Vulnerability: Stored Cross-Site Scripting (XSS) in Moodle PDF Annotator plugin (v1.5 release 9)
Author: Onurcan Genç (Independent Security Researcher)
Tested Environment:

Bitnami Docker Image for Moodle 4.x

Plugin: mod_pdfannotator v1.5 (release 9, build 2025090300)

Browser: Chrome 129.0.6668.59 (Windows 11)

1. Vulnerability Summary

The Public Comments feature in the Moodle PDF Annotator plugin fails to sanitize user input before rendering it within the PDF viewer interface.
As a result, a low-privileged attacker (e.g., a student) can inject malicious JavaScript payloads into the comment field, which are later executed in the browsers of other users who open the same annotated PDF document.

2. Affected Component

/mod/pdfannotator/view.php and /mod/pdfannotator/ajax.php
→ The vulnerable input originates from the “Add Public Comment” action in view.php.
→ The unsanitized payload is displayed when comments are loaded via AJAX and rendered by the PDF.js viewer.

3. Attack Scenario
   Step 1 — Attacker Action

The attacker, logged in as a Student, opens a PDF Annotator activity and adds a Public Comment:

Alternatively, a stealthier payload for session hijacking:

Check for GitHub Adversary explanation for payloads.

Step 2 — Trigger Condition

When another user (Student, Teacher, or Admin) opens the same annotated PDF activity,
the malicious comment is rendered directly into the DOM of the PDF viewer,
executing the injected script in the victim’s browser context.

Step 3 — Result

Stored XSS Execution: Payload executes automatically when the PDF is viewed.

Potential Impacts:

Session hijacking (via stolen MoodleSession)

Credential or token theft

Forced administrative actions

Defacement or phishing via injected HTML/JS

4. Technical Analysis
   Parameter	Value
   Endpoint	/mod/pdfannotator/ajax.php?action=save_comment
   Method	POST
   Parameter	content
   Affected Role	Student (Authenticated user)
   Sanitization	Missing HTML escaping before output
   Output Context	Rendered within innerHTML in PDF.js comment panel

Example intercepted request:

POST /mod/pdfannotator/ajax.php?action=save_comment&id=3 HTTP/1.1
Host: moodle.local
Cookie: MoodleSession=xyz123
Content-Type: application/x-www-form-urlencoded

content=<script>alert(1)</script>&userid=8&pdfid=5

Response:

{"status":"success","message":"Comment saved successfully"}

Upon reloading the annotated PDF, the injected <script> executes.

5. Proof of Execution

create any comment on the document that you submitted and apply the payload below->

'"><img src=x onerror=alert(1)>'

Alert box shown inside PDF Annotator frame when viewing injected comment.

6. Impact Assessment (CVSS v3.1)
   Metric	Value
   Attack Vector	Network
   Attack Complexity	Low
   Privileges Required	Low
   User Interaction	Required
   Scope	Changed
   Confidentiality	High
   Integrity	High
   Availability	Low
   CVSS Score	8.0 (High)
   Vector String	CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L
7. Mitigation & Recommendations

\- Properly escape/sanitize user-supplied data in Public Comments before rendering.

\- Use Moodle’s built-in format_text() with FORMAT_HTML sanitization.

\- Apply Content-Security-Policy (CSP) headers to disallow inline JavaScript execution.

8. References

https://onurcangenc.com.tr/blog/moodle-xss-pdfannotator

https://github.com/onurcangnc/moodle-xss-pdfannotator

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-60506
